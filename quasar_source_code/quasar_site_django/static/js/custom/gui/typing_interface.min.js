'use strict';function TypingInterface(){this.__init__();}
function Message(text,created_time){this.__init__(text,created_time);}
Message.prototype={__init__:function(text,created_time){this.text=text;this.created_time=created_time;}}
const MESSAGE_TYPE_PLAYER_CHAT=3;const MESSAGE_TYPE_SERVER=2;const MESSAGE_TYPE_USER=1;TypingInterface.prototype={__init__:function(){this.gui_typing=new DomElement('gui_typing');this.gui_typing_input=new DomElement('gui_typing_input_field');this.gui_logs=new DomElement('gui_console_logs');this.input_text=new InputTextProcessor('');this.visible=false;this.all_rows=[];var i=0;while(i<70){this.all_rows.push(new DomElement('row_'+i.toString()));i+=1;}
this.messages=[];this.window_was_resized();this.needs_another_update=false;},is_visible:function(){return this.visible;},toggle_visibility:function(){this.visible=!this.visible;if(this.visible){this.show();}else{this.hide();}},show:function(){this.gui_typing.show();this.visible=true;},hide:function(){this.gui_typing.hide();this.visible=false;this.input_text.clear_text();},key_down_event:function(event){this.input_text.parse_key_event(event);this.gui_typing_input.set_text(this.input_text.get_text());},window_was_resized:function(){var window_height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this.current_height=window_height*0.7;var row_size=12+2;var number_of_rows_that_fit=this.current_height/row_size;this.last_row=Math.floor(number_of_rows_that_fit)-1;this.update();},get_normal_text_color:function(alpha){return'rgba(118, 255, 137, '+alpha.toString()+')';},get_server_text_color:function(alpha){return'rgba(255, 53, 36,'+alpha.toString()+')';},get_player_message_text_color:function(alpha){return'rgba(113, 236, 255, '+alpha.toString()+');';},needs_an_update:function(){return this.needs_another_update;},update:function(){var needs_one_more_update=false;var i=this.last_row;var m=0;while(i>-1){if(this.messages.length>m){this.all_rows[i].set_text(this.messages[m][0]);switch(this.messages[m][1]){case MESSAGE_TYPE_SERVER:this.all_rows[i].set_color(this.get_server_text_color(0.85));break;case MESSAGE_TYPE_USER:this.all_rows[i].set_color(this.get_normal_text_color(0.85));break;case MESSAGE_TYPE_PLAYER_CHAT:this.all_rows[i].set_color(this.get_player_message_text_color(0.85));break;}}else{this.all_rows[i].set_text('');}
i-=1;m+=1;}
var j=this.last_row+1;while(j<70){this.all_rows[j].set_text('');j+=1;}
this.needs_another_update=needs_one_more_update;},add_chat_message:function(message){this.add_message(message,MESSAGE_TYPE_PLAYER_CHAT);},add_message:function(text_message,text_color){this.messages.unshift([text_message,text_color]);this.update();},add_user_text:function(){var current_input=this.input_text.get_text();if(current_input.length>0){MANAGER_WORLD.player.send_chat_message(current_input);}},add_server_message:function(server_message){this.add_message('server : '+server_message,MESSAGE_TYPE_SERVER);}};